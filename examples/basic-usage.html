<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>EkteIntelligens SDK - Basic Usage</title>
        <style>
            body {
                font-family: Arial, sans-serif;
                max-width: 800px;
                margin: 0 auto;
                padding: 20px;
            }
            .form-group {
                margin-bottom: 15px;
            }
            label {
                display: block;
                margin-bottom: 5px;
                font-weight: bold;
            }
            input {
                width: 100%;
                padding: 8px;
                border: 1px solid #ddd;
                border-radius: 4px;
            }
            button {
                background-color: #007bff;
                color: white;
                padding: 10px 20px;
                border: none;
                border-radius: 4px;
                cursor: pointer;
            }
            button:hover {
                background-color: #0056b3;
            }
            .status {
                margin-top: 20px;
                padding: 10px;
                border-radius: 4px;
            }
            .success {
                background-color: #d4edda;
                color: #155724;
                border: 1px solid #c3e6cb;
            }
            .error {
                background-color: #f8d7da;
                color: #721c24;
                border: 1px solid #f5c6cb;
            }
        </style>
    </head>
    <body>
        <h1>EkteIntelligens SDK - Basic Usage</h1>

        <form id="checkout-form">
            <div class="form-group">
                <label for="name">Name:</label>
                <input
                    type="text"
                    id="name"
                    name="name"
                    placeholder="Enter your name"
                />
            </div>

            <div class="form-group">
                <label for="email">Email:</label>
                <input
                    type="email"
                    id="email"
                    name="email"
                    placeholder="Enter your email"
                />
            </div>

            <div class="form-group">
                <label for="phone">Phone:</label>
                <input
                    type="tel"
                    id="phone"
                    name="phone"
                    placeholder="Enter your phone number"
                />
            </div>

            <div class="form-group">
                <label for="address">Address:</label>
                <input
                    type="text"
                    id="address"
                    name="address"
                    placeholder="Enter your address"
                />
            </div>

            <button type="submit">Submit Order</button>
        </form>

        <!-- Example products for detection -->
        <div
            class="product-item"
            data-product-id="123"
            data-product-name="Sample Product"
            data-price="29.99"
            data-quantity="1"
        >
            <span class="product-name">Sample Product</span>
            <span class="product-price">$29.99</span>
            <span class="product-quantity">1</span>
        </div>

        <div id="status" class="status" style="display: none"></div>

        <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
        <script src="../dist/index.js"></script>
        <script>
            // Initialize the SDK
            const sdk = new EkteIntelligensSDK({
                organizationId: "your-org-id",
                checkoutCampaignId: "your-campaign-id",
                // Supabase credentials are optional - SDK uses our backend by default
                features: {
                    abandonedCart: true,
                },
            });

            // Initialize the SDK
            sdk.initialize()
                .then((success) => {
                    if (success) {
                        showStatus("SDK initialized successfully!", "success");

                        // Get the abandoned cart tool
                        const abandonedCartTool = sdk.getAbandonedCartTool();
                        if (abandonedCartTool) {
                            console.log("Abandoned cart tool is ready");
                        }
                    } else {
                        showStatus("Failed to initialize SDK", "error");
                    }
                })
                .catch((error) => {
                    showStatus(
                        "Error initializing SDK: " + error.message,
                        "error"
                    );
                });

            // Handle form submission
            document
                .getElementById("checkout-form")
                .addEventListener("submit", function (e) {
                    e.preventDefault();

                    const abandonedCartTool = sdk.getAbandonedCartTool();
                    if (abandonedCartTool) {
                        const content = abandonedCartTool.getContent();
                        const hasContact = abandonedCartTool.hasEmailOrPhone();

                        showStatus(
                            `Form submitted! Content: ${JSON.stringify(
                                content
                            )}. Has contact: ${hasContact}`,
                            "success"
                        );
                    }
                });

            function showStatus(message, type) {
                const statusDiv = document.getElementById("status");
                statusDiv.textContent = message;
                statusDiv.className = `status ${type}`;
                statusDiv.style.display = "block";
            }
        </script>
    </body>
</html>
